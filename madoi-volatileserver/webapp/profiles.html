<html>
<head>
<meta charset="utf8">
</head>
<body>
<script src="./js/madoi.js"></script>
<script>
window.addEventListener("load", ()=>{
  // Madoiクライアントを作成しサーバに接続する。
  // 引数はルームのIDとAPI KEY。
  const m = new madoi.Madoi(
    "tutorial001_xoeirj34f?apikey=ahfuTep6ooDi7Oa4",
    {},
    {background: "back.png"});

  // ウィンドウがクリックされたら、メッセージを送信する。
  window.addEventListener("click", e=>{
    // 第一引数はメッセージタイプ。第二引数はメッセージ内容
    m.send("windowClick", "hello");
    m.setRoomProfile("hello", "world");
  });

  // "windowClick"タイプのメッセージを受信したら、documentにdivタグを追加する。
  m.addReceiver("windowClick", e=>{
  //({detail: {body}})
    console.log(e);
    const {detail: {body}} = e;
    const div = document.createElement("div");
    div.innerText = body;
    document.body.append(div);
  });
  m.addEventListener("roomProfileUpdated", ({detail})=>{
    console.log(detail);
  });
});
</script>
</body>
</html>
